Global
Viper

2022/10/29 15:37:07 /data/go/pkg/mod/gorm.io/driver/mysql@v1.3.3/migrator.go:228
[0.435ms] [rows:-] SELECT DATABASE()

2022/10/29 15:37:07 /data/go/pkg/mod/gorm.io/driver/mysql@v1.3.3/migrator.go:231
[5.483ms] [rows:1] SELECT SCHEMA_NAME from Information_schema.SCHEMATA where SCHEMA_NAME LIKE 'douyin%' ORDER BY SCHEMA_NAME='douyin' DESC limit 1

2022/10/29 15:37:07 /home/cheng/Desktop/Linux/douyin-fighting/initialize/mysql.go:54
[0.351ms] [rows:-] SELECT count(*) FROM information_schema.tables WHERE table_schema = 'douyin' AND table_name = 'users' AND table_type = 'BASE TABLE'

2022/10/29 15:37:07 /data/go/pkg/mod/gorm.io/driver/mysql@v1.3.3/migrator.go:228
[0.140ms] [rows:-] SELECT DATABASE()

2022/10/29 15:37:07 /data/go/pkg/mod/gorm.io/driver/mysql@v1.3.3/migrator.go:231
[1.040ms] [rows:1] SELECT SCHEMA_NAME from Information_schema.SCHEMATA where SCHEMA_NAME LIKE 'douyin%' ORDER BY SCHEMA_NAME='douyin' DESC limit 1

2022/10/29 15:37:07 /data/go/pkg/mod/gorm.io/driver/mysql@v1.3.3/migrator.go:148
[1.611ms] [rows:-] SELECT * FROM `users` LIMIT 1

2022/10/29 15:37:07 /data/go/pkg/mod/gorm.io/driver/mysql@v1.3.3/migrator.go:166
[0.619ms] [rows:-] SELECT column_name, column_default, is_nullable = 'YES', data_type, character_maximum_length, column_type, column_key, extra, column_comment, numeric_precision, numeric_scale , datetime_precision FROM information_schema.columns WHERE table_schema = 'douyin' AND table_name = 'users' ORDER BY ORDINAL_POSITION

2022/10/29 15:37:07 /data/go/pkg/mod/gorm.io/driver/mysql@v1.3.3/migrator.go:228
[0.137ms] [rows:-] SELECT DATABASE()

2022/10/29 15:37:07 /data/go/pkg/mod/gorm.io/driver/mysql@v1.3.3/migrator.go:231
[0.437ms] [rows:1] SELECT SCHEMA_NAME from Information_schema.SCHEMATA where SCHEMA_NAME LIKE 'douyin%' ORDER BY SCHEMA_NAME='douyin' DESC limit 1

2022/10/29 15:37:07 /home/cheng/Desktop/Linux/douyin-fighting/initialize/mysql.go:55
[0.382ms] [rows:-] SELECT count(*) FROM information_schema.tables WHERE table_schema = 'douyin' AND table_name = 'videos' AND table_type = 'BASE TABLE'

2022/10/29 15:37:07 /data/go/pkg/mod/gorm.io/driver/mysql@v1.3.3/migrator.go:228
[0.127ms] [rows:-] SELECT DATABASE()

2022/10/29 15:37:07 /data/go/pkg/mod/gorm.io/driver/mysql@v1.3.3/migrator.go:231
[0.368ms] [rows:1] SELECT SCHEMA_NAME from Information_schema.SCHEMATA where SCHEMA_NAME LIKE 'douyin%' ORDER BY SCHEMA_NAME='douyin' DESC limit 1

2022/10/29 15:37:07 /data/go/pkg/mod/gorm.io/driver/mysql@v1.3.3/migrator.go:148
[0.727ms] [rows:-] SELECT * FROM `videos` LIMIT 1

2022/10/29 15:37:07 /data/go/pkg/mod/gorm.io/driver/mysql@v1.3.3/migrator.go:166
[1.216ms] [rows:-] SELECT column_name, column_default, is_nullable = 'YES', data_type, character_maximum_length, column_type, column_key, extra, column_comment, numeric_precision, numeric_scale , datetime_precision FROM information_schema.columns WHERE table_schema = 'douyin' AND table_name = 'videos' ORDER BY ORDINAL_POSITION

2022/10/29 15:37:07 /data/go/pkg/mod/gorm.io/driver/mysql@v1.3.3/migrator.go:228
[0.132ms] [rows:-] SELECT DATABASE()

2022/10/29 15:37:07 /data/go/pkg/mod/gorm.io/driver/mysql@v1.3.3/migrator.go:231
[1.451ms] [rows:1] SELECT SCHEMA_NAME from Information_schema.SCHEMATA where SCHEMA_NAME LIKE 'douyin%' ORDER BY SCHEMA_NAME='douyin' DESC limit 1

2022/10/29 15:37:07 /home/cheng/Desktop/Linux/douyin-fighting/initialize/mysql.go:55
[0.394ms] [rows:-] SELECT count(*) FROM information_schema.statistics WHERE table_schema = 'douyin' AND table_name = 'videos' AND index_name = 'idx_videos_created_at'

2022/10/29 15:37:07 /data/go/pkg/mod/gorm.io/driver/mysql@v1.3.3/migrator.go:228
[0.103ms] [rows:-] SELECT DATABASE()

2022/10/29 15:37:07 /data/go/pkg/mod/gorm.io/driver/mysql@v1.3.3/migrator.go:231
[0.337ms] [rows:1] SELECT SCHEMA_NAME from Information_schema.SCHEMATA where SCHEMA_NAME LIKE 'douyin%' ORDER BY SCHEMA_NAME='douyin' DESC limit 1

2022/10/29 15:37:07 /home/cheng/Desktop/Linux/douyin-fighting/initialize/mysql.go:55
[0.252ms] [rows:-] SELECT count(*) FROM information_schema.statistics WHERE table_schema = 'douyin' AND table_name = 'videos' AND index_name = 'idx_videos_author_id'

2022/10/29 15:37:07 /data/go/pkg/mod/gorm.io/driver/mysql@v1.3.3/migrator.go:228
[0.135ms] [rows:-] SELECT DATABASE()

2022/10/29 15:37:07 /data/go/pkg/mod/gorm.io/driver/mysql@v1.3.3/migrator.go:231
[0.807ms] [rows:1] SELECT SCHEMA_NAME from Information_schema.SCHEMATA where SCHEMA_NAME LIKE 'douyin%' ORDER BY SCHEMA_NAME='douyin' DESC limit 1

2022/10/29 15:37:07 /home/cheng/Desktop/Linux/douyin-fighting/initialize/mysql.go:56
[0.480ms] [rows:-] SELECT count(*) FROM information_schema.tables WHERE table_schema = 'douyin' AND table_name = 'favorites' AND table_type = 'BASE TABLE'

2022/10/29 15:37:07 /data/go/pkg/mod/gorm.io/driver/mysql@v1.3.3/migrator.go:228
[0.219ms] [rows:-] SELECT DATABASE()

2022/10/29 15:37:07 /data/go/pkg/mod/gorm.io/driver/mysql@v1.3.3/migrator.go:231
[0.979ms] [rows:1] SELECT SCHEMA_NAME from Information_schema.SCHEMATA where SCHEMA_NAME LIKE 'douyin%' ORDER BY SCHEMA_NAME='douyin' DESC limit 1

2022/10/29 15:37:07 /data/go/pkg/mod/gorm.io/driver/mysql@v1.3.3/migrator.go:148
[0.220ms] [rows:-] SELECT * FROM `favorites` LIMIT 1

2022/10/29 15:37:07 /data/go/pkg/mod/gorm.io/driver/mysql@v1.3.3/migrator.go:166
[5.636ms] [rows:-] SELECT column_name, column_default, is_nullable = 'YES', data_type, character_maximum_length, column_type, column_key, extra, column_comment, numeric_precision, numeric_scale , datetime_precision FROM information_schema.columns WHERE table_schema = 'douyin' AND table_name = 'favorites' ORDER BY ORDINAL_POSITION

2022/10/29 15:37:07 /data/go/pkg/mod/gorm.io/driver/mysql@v1.3.3/migrator.go:228
[0.175ms] [rows:-] SELECT DATABASE()

2022/10/29 15:37:07 /data/go/pkg/mod/gorm.io/driver/mysql@v1.3.3/migrator.go:231
[0.404ms] [rows:1] SELECT SCHEMA_NAME from Information_schema.SCHEMATA where SCHEMA_NAME LIKE 'douyin%' ORDER BY SCHEMA_NAME='douyin' DESC limit 1

2022/10/29 15:37:07 /home/cheng/Desktop/Linux/douyin-fighting/initialize/mysql.go:56
[0.643ms] [rows:-] SELECT count(*) FROM information_schema.statistics WHERE table_schema = 'douyin' AND table_name = 'favorites' AND index_name = 'idx_01'

2022/10/29 15:37:07 /data/go/pkg/mod/gorm.io/driver/mysql@v1.3.3/migrator.go:228
[0.091ms] [rows:-] SELECT DATABASE()

2022/10/29 15:37:07 /data/go/pkg/mod/gorm.io/driver/mysql@v1.3.3/migrator.go:231
[0.369ms] [rows:1] SELECT SCHEMA_NAME from Information_schema.SCHEMATA where SCHEMA_NAME LIKE 'douyin%' ORDER BY SCHEMA_NAME='douyin' DESC limit 1

2022/10/29 15:37:07 /home/cheng/Desktop/Linux/douyin-fighting/initialize/mysql.go:56
[0.302ms] [rows:-] SELECT count(*) FROM information_schema.statistics WHERE table_schema = 'douyin' AND table_name = 'favorites' AND index_name = 'idx_02'

2022/10/29 15:37:07 /data/go/pkg/mod/gorm.io/driver/mysql@v1.3.3/migrator.go:228
[0.278ms] [rows:-] SELECT DATABASE()

2022/10/29 15:37:07 /data/go/pkg/mod/gorm.io/driver/mysql@v1.3.3/migrator.go:231
[0.452ms] [rows:1] SELECT SCHEMA_NAME from Information_schema.SCHEMATA where SCHEMA_NAME LIKE 'douyin%' ORDER BY SCHEMA_NAME='douyin' DESC limit 1

2022/10/29 15:37:07 /home/cheng/Desktop/Linux/douyin-fighting/initialize/mysql.go:57
[0.230ms] [rows:-] SELECT count(*) FROM information_schema.tables WHERE table_schema = 'douyin' AND table_name = 'comments' AND table_type = 'BASE TABLE'

2022/10/29 15:37:07 /data/go/pkg/mod/gorm.io/driver/mysql@v1.3.3/migrator.go:228
[0.190ms] [rows:-] SELECT DATABASE()

2022/10/29 15:37:07 /data/go/pkg/mod/gorm.io/driver/mysql@v1.3.3/migrator.go:231
[1.288ms] [rows:1] SELECT SCHEMA_NAME from Information_schema.SCHEMATA where SCHEMA_NAME LIKE 'douyin%' ORDER BY SCHEMA_NAME='douyin' DESC limit 1

2022/10/29 15:37:07 /data/go/pkg/mod/gorm.io/driver/mysql@v1.3.3/migrator.go:148
[0.317ms] [rows:-] SELECT * FROM `comments` LIMIT 1

2022/10/29 15:37:07 /data/go/pkg/mod/gorm.io/driver/mysql@v1.3.3/migrator.go:166
[0.459ms] [rows:-] SELECT column_name, column_default, is_nullable = 'YES', data_type, character_maximum_length, column_type, column_key, extra, column_comment, numeric_precision, numeric_scale , datetime_precision FROM information_schema.columns WHERE table_schema = 'douyin' AND table_name = 'comments' ORDER BY ORDINAL_POSITION

2022/10/29 15:37:07 /data/go/pkg/mod/gorm.io/driver/mysql@v1.3.3/migrator.go:228
[0.236ms] [rows:-] SELECT DATABASE()

2022/10/29 15:37:07 /data/go/pkg/mod/gorm.io/driver/mysql@v1.3.3/migrator.go:231
[0.402ms] [rows:1] SELECT SCHEMA_NAME from Information_schema.SCHEMATA where SCHEMA_NAME LIKE 'douyin%' ORDER BY SCHEMA_NAME='douyin' DESC limit 1

2022/10/29 15:37:07 /home/cheng/Desktop/Linux/douyin-fighting/initialize/mysql.go:57
[0.219ms] [rows:-] SELECT count(*) FROM information_schema.statistics WHERE table_schema = 'douyin' AND table_name = 'comments' AND index_name = 'video_user'

2022/10/29 15:37:07 /data/go/pkg/mod/gorm.io/driver/mysql@v1.3.3/migrator.go:228
[0.130ms] [rows:-] SELECT DATABASE()

2022/10/29 15:37:07 /data/go/pkg/mod/gorm.io/driver/mysql@v1.3.3/migrator.go:231
[0.249ms] [rows:1] SELECT SCHEMA_NAME from Information_schema.SCHEMATA where SCHEMA_NAME LIKE 'douyin%' ORDER BY SCHEMA_NAME='douyin' DESC limit 1

2022/10/29 15:37:07 /home/cheng/Desktop/Linux/douyin-fighting/initialize/mysql.go:58
[0.812ms] [rows:-] SELECT count(*) FROM information_schema.tables WHERE table_schema = 'douyin' AND table_name = 'follows' AND table_type = 'BASE TABLE'

2022/10/29 15:37:07 /data/go/pkg/mod/gorm.io/driver/mysql@v1.3.3/migrator.go:228
[0.165ms] [rows:-] SELECT DATABASE()

2022/10/29 15:37:07 /data/go/pkg/mod/gorm.io/driver/mysql@v1.3.3/migrator.go:231
[0.354ms] [rows:1] SELECT SCHEMA_NAME from Information_schema.SCHEMATA where SCHEMA_NAME LIKE 'douyin%' ORDER BY SCHEMA_NAME='douyin' DESC limit 1

2022/10/29 15:37:07 /data/go/pkg/mod/gorm.io/driver/mysql@v1.3.3/migrator.go:148
[0.792ms] [rows:-] SELECT * FROM `follows` LIMIT 1

2022/10/29 15:37:07 /data/go/pkg/mod/gorm.io/driver/mysql@v1.3.3/migrator.go:166
[0.448ms] [rows:-] SELECT column_name, column_default, is_nullable = 'YES', data_type, character_maximum_length, column_type, column_key, extra, column_comment, numeric_precision, numeric_scale , datetime_precision FROM information_schema.columns WHERE table_schema = 'douyin' AND table_name = 'follows' ORDER BY ORDINAL_POSITION

2022/10/29 15:37:07 /data/go/pkg/mod/gorm.io/driver/mysql@v1.3.3/migrator.go:228
[0.139ms] [rows:-] SELECT DATABASE()

2022/10/29 15:37:07 /data/go/pkg/mod/gorm.io/driver/mysql@v1.3.3/migrator.go:231
[1.052ms] [rows:1] SELECT SCHEMA_NAME from Information_schema.SCHEMATA where SCHEMA_NAME LIKE 'douyin%' ORDER BY SCHEMA_NAME='douyin' DESC limit 1

2022/10/29 15:37:07 /home/cheng/Desktop/Linux/douyin-fighting/initialize/mysql.go:58
[0.529ms] [rows:-] SELECT count(*) FROM information_schema.statistics WHERE table_schema = 'douyin' AND table_name = 'follows' AND index_name = 'idx_01'

2022/10/29 15:37:07 /data/go/pkg/mod/gorm.io/driver/mysql@v1.3.3/migrator.go:228
[0.152ms] [rows:-] SELECT DATABASE()

2022/10/29 15:37:07 /data/go/pkg/mod/gorm.io/driver/mysql@v1.3.3/migrator.go:231
[0.357ms] [rows:1] SELECT SCHEMA_NAME from Information_schema.SCHEMATA where SCHEMA_NAME LIKE 'douyin%' ORDER BY SCHEMA_NAME='douyin' DESC limit 1

2022/10/29 15:37:07 /home/cheng/Desktop/Linux/douyin-fighting/initialize/mysql.go:58
[0.270ms] [rows:-] SELECT count(*) FROM information_schema.statistics WHERE table_schema = 'douyin' AND table_name = 'follows' AND index_name = 'idx_02'
MySQL

2022/10/29 15:37:07 /home/cheng/Desktop/Linux/douyin-fighting/service/video_redis.go:47
[0.178ms] [rows:1] SELECT * FROM `videos`
Redis
1111111111111111111
0.0.0.0:8080
2022/10/29 15:37:16 /home/cheng/Desktop/Linux/douyin-fighting/service/favorite.go:114
[0.660ms] [rows:0] SELECT `video_id`,`is_favorite` FROM `favorites` WHERE user_id = 23473621196361089
GetVideoListByIDsRedis: later

2022/10/29 15:37:16 /home/cheng/Desktop/Linux/douyin-fighting/service/follow.go:105
[0.571ms] [rows:0] SELECT `celebrity_id`,`is_follow` FROM `follows` WHERE follower_id = 23473621196361089
[GIN] 2022/10/29 - 15:37:16 | 200 |    2.931595ms |    192.168.77.1 | GET      "/douyin/favorite/list/?token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJVc2VySUQiOjIzNDczNjIxMTk2MzYxMDg5LCJOYW1lIjoiMSIsImV4cCI6MTY2NzE2OTAwNCwibmJmIjoxNjY3MDgyNjA0LCJpYXQiOjE2NjcwODI2MDR9.7AW9arvaxKEhnfnW4VMvyHNC3uLKPZjuHBLuNH-3hFM&user_id=23473621196361089"

2022/10/29 15:37:16 /home/cheng/Desktop/Linux/douyin-fighting/service/video.go:135
[7.245ms] [rows:0] SELECT * FROM `videos` WHERE author_id = 23473621196361089

2022/10/29 15:37:16 /home/cheng/Desktop/Linux/douyin-fighting/service/user.go:51
[1.156ms] [rows:1] SELECT * FROM `users` WHERE user_id = 23473621196361089 LIMIT 1

2022/10/29 15:37:16 /home/cheng/Desktop/Linux/douyin-fighting/service/user.go:54
[0.465ms] [rows:1] SELECT count(*) FROM `follows` WHERE follower_id = 23473621196361089 and is_follow = true

2022/10/29 15:37:16 /home/cheng/Desktop/Linux/douyin-fighting/service/user.go:57
[0.342ms] [rows:1] SELECT count(*) FROM `follows` WHERE celebrity_id = 23473621196361089 and is_follow = true

2022/10/29 15:37:16 /home/cheng/Desktop/Linux/douyin-fighting/service/user.go:60
[1.180ms] [rows:1] SELECT count(*) FROM `favorites` WHERE user_id = 23473621196361089 and is_favorite = true
[GIN] 2022/10/29 - 15:37:16 | 200 |   13.039903ms |    192.168.77.1 | GET      "/douyin/publish/list/?token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJVc2VySUQiOjIzNDczNjIxMTk2MzYxMDg5LCJOYW1lIjoiMSIsImV4cCI6MTY2NzE2OTAwNCwibmJmIjoxNjY3MDgyNjA0LCJpYXQiOjE2NjcwODI2MDR9.7AW9arvaxKEhnfnW4VMvyHNC3uLKPZjuHBLuNH-3hFM&user_id=23473621196361089"
Feed ================
GetFeed 1
GetFeed 2
GetFeed 3
[23473691677445505]
GetVideoListByIDsRedis: later

2022/10/29 15:37:19 /home/cheng/Desktop/Linux/douyin-fighting/service/video.go:268
[1.163ms] [rows:1] SELECT * FROM `videos` WHERE video_id in (23473691677445505)

2022/10/29 15:37:19 /home/cheng/Desktop/Linux/douyin-fighting/service/comment.go:209
[0.407ms] [rows:0] SELECT `video_id`,COUNT(video_id) as comment_count FROM `comments` WHERE video_id in (23473691677445505) AND `comments`.`deleted_at` IS NULL GROUP BY `video_id`

2022/10/29 15:37:19 /home/cheng/Desktop/Linux/douyin-fighting/service/favorite.go:178
[0.347ms] [rows:0] SELECT `video_id`,COUNT(video_id) as favorite_count FROM `favorites` WHERE video_id in (23473691677445505) and is_favorite = true GROUP BY `video_id`
GetVideoListByIDsSql: 
GetVideoListByIDsRedis:  &[{0    0 0 0 0001-01-01 00:00:00 +0000 UTC <nil>}]  
 [23473691677445505]
numVideos:  0
[GIN] 2022/10/29 - 15:37:19 | 500 |    2.783161ms |    192.168.77.1 | GET      "/douyin/feed/?latest_time=1667083039985"

2022/10/29 15:37:30 /home/cheng/Desktop/Linux/douyin-fighting/service/user.go:28
[0.457ms] [rows:1] SELECT * FROM `users` WHERE name = '1' LIMIT 1
[GIN] 2022/10/29 - 15:37:30 | 200 |   60.746232ms |    192.168.77.1 | POST     "/douyin/user/login/?username=1&password=111111"

2022/10/29 15:37:30 /home/cheng/Desktop/Linux/douyin-fighting/service/follow.go:20
[0.336ms] [rows:0] SELECT `celebrity_id`,`is_follow` FROM `follows` WHERE follower_id = 0
[GIN] 2022/10/29 - 15:37:30 | 200 |     703.151µs |    192.168.77.1 | GET      "/douyin/user/?user_id=23473621196361089&token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJVc2VySUQiOjIzNDczNjIxMTk2MzYxMDg5LCJOYW1lIjoiMSIsImV4cCI6MTY2NzE2OTQ1MCwibmJmIjoxNjY3MDgzMDUwLCJpYXQiOjE2NjcwODMwNTB9.ThoK96Tv8SgmOKOhJff9ukH9VDgmX5qqTEu7mMyD0Vw"
[GIN] 2022/10/29 - 15:37:30 | 200 |     430.738µs |    192.168.77.1 | GET      "/douyin/publish/list/?token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJVc2VySUQiOjIzNDczNjIxMTk2MzYxMDg5LCJOYW1lIjoiMSIsImV4cCI6MTY2NzE2OTQ1MCwibmJmIjoxNjY3MDgzMDUwLCJpYXQiOjE2NjcwODMwNTB9.ThoK96Tv8SgmOKOhJff9ukH9VDgmX5qqTEu7mMyD0Vw&user_id=23473621196361089"
GetVideoListByIDsRedis: later
[GIN] 2022/10/29 - 15:37:30 | 200 |     421.292µs |    192.168.77.1 | GET      "/douyin/favorite/list/?token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJVc2VySUQiOjIzNDczNjIxMTk2MzYxMDg5LCJOYW1lIjoiMSIsImV4cCI6MTY2NzE2OTQ1MCwibmJmIjoxNjY3MDgzMDUwLCJpYXQiOjE2NjcwODMwNTB9.ThoK96Tv8SgmOKOhJff9ukH9VDgmX5qqTEu7mMyD0Vw&user_id=23473621196361089"
publish 1111111111111111111
publish 2222222222222
publish 3333333333333
insert db

2022/10/29 15:37:39 /home/cheng/Desktop/Linux/douyin-fighting/service/video.go:84
[1.413ms] [rows:1] INSERT INTO `videos` (`title`,`play_name`,`cover_name`,`author_id`,`created_at`,`ext_info`,`video_id`) VALUES ('a','23474442524970369','23474442524970369.jpg',0,'2022-10-29 15:37:39.207',NULL,23474442524970369)
redis
redis 1

2022/10/29 15:37:39 /home/cheng/Desktop/Linux/douyin-fighting/service/video.go:102
[0.353ms] [rows:2] SELECT * FROM `videos` WHERE author_id = 0
redis 2
redis 3
pipe 
pipe 1
pipe 2
pipe 3
pipe 4
[GIN] 2022/10/29 - 15:37:39 | 200 |  130.658001ms |    192.168.77.1 | POST     "/douyin/publish/action/"
GetVideoListByIDsRedis: later
[GIN] 2022/10/29 - 15:37:40 | 200 |     262.736µs |    192.168.77.1 | GET      "/douyin/publish/list/?token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJVc2VySUQiOjIzNDczNjIxMTk2MzYxMDg5LCJOYW1lIjoiMSIsImV4cCI6MTY2NzE2OTQ1MCwibmJmIjoxNjY3MDgzMDUwLCJpYXQiOjE2NjcwODMwNTB9.ThoK96Tv8SgmOKOhJff9ukH9VDgmX5qqTEu7mMyD0Vw&user_id=23473621196361089"
[GIN] 2022/10/29 - 15:37:40 | 200 |     628.903µs |    192.168.77.1 | GET      "/douyin/favorite/list/?token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJVc2VySUQiOjIzNDczNjIxMTk2MzYxMDg5LCJOYW1lIjoiMSIsImV4cCI6MTY2NzE2OTQ1MCwibmJmIjoxNjY3MDgzMDUwLCJpYXQiOjE2NjcwODMwNTB9.ThoK96Tv8SgmOKOhJff9ukH9VDgmX5qqTEu7mMyD0Vw&user_id=23473621196361089"
GetVideoListByIDsRedis: later
[GIN] 2022/10/29 - 15:37:50 | 200 |     256.339µs |    192.168.77.1 | GET      "/douyin/publish/list/?token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJVc2VySUQiOjIzNDczNjIxMTk2MzYxMDg5LCJOYW1lIjoiMSIsImV4cCI6MTY2NzE2OTQ1MCwibmJmIjoxNjY3MDgzMDUwLCJpYXQiOjE2NjcwODMwNTB9.ThoK96Tv8SgmOKOhJff9ukH9VDgmX5qqTEu7mMyD0Vw&user_id=23473621196361089"
[GIN] 2022/10/29 - 15:37:50 | 200 |     509.599µs |    192.168.77.1 | GET      "/douyin/favorite/list/?token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJVc2VySUQiOjIzNDczNjIxMTk2MzYxMDg5LCJOYW1lIjoiMSIsImV4cCI6MTY2NzE2OTQ1MCwibmJmIjoxNjY3MDgzMDUwLCJpYXQiOjE2NjcwODMwNTB9.ThoK96Tv8SgmOKOhJff9ukH9VDgmX5qqTEu7mMyD0Vw&user_id=23473621196361089"
Feed ================
GetFeed 1
GetFeed 2
numVideos:  0
GetFeed 1
GetFeed 2
GetFeed 3
[23474442524970369 23473691677445505]
Video:23474442524970369 : in redis
GetVideoListByIDsRedis: later

2022/10/29 15:37:53 /home/cheng/Desktop/Linux/douyin-fighting/service/video.go:268
[0.436ms] [rows:1] SELECT * FROM `videos` WHERE video_id in (23473691677445505)

2022/10/29 15:37:53 /home/cheng/Desktop/Linux/douyin-fighting/service/comment.go:209
[0.282ms] [rows:0] SELECT `video_id`,COUNT(video_id) as comment_count FROM `comments` WHERE video_id in (23473691677445505) AND `comments`.`deleted_at` IS NULL GROUP BY `video_id`

2022/10/29 15:37:53 /home/cheng/Desktop/Linux/douyin-fighting/service/favorite.go:178
[0.297ms] [rows:0] SELECT `video_id`,COUNT(video_id) as favorite_count FROM `favorites` WHERE video_id in (23473691677445505) and is_favorite = true GROUP BY `video_id`
GetVideoListByIDsSql: 
GetVideoListByIDsRedis:  &[{23474442524970369 a 23474442524970369 23474442524970369.jpg 0 0 0 2022-10-29 15:37:39.207 -0700 PDT <nil>} {0    0 0 0 0001-01-01 00:00:00 +0000 UTC <nil>}]  
 [23474442524970369 23473691677445505]
numVideos:  0
[GIN] 2022/10/29 - 15:37:53 | 200 |    1.746267ms |    192.168.77.1 | GET      "/douyin/feed/?latest_time=0&token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJVc2VySUQiOjIzNDczNjIxMTk2MzYxMDg5LCJOYW1lIjoiMSIsImV4cCI6MTY2NzE2OTQ1MCwibmJmIjoxNjY3MDgzMDUwLCJpYXQiOjE2NjcwODMwNTB9.ThoK96Tv8SgmOKOhJff9ukH9VDgmX5qqTEu7mMyD0Vw"
publish 1111111111111111111
publish 2222222222222
publish 3333333333333
insert db

2022/10/29 15:38:26 /home/cheng/Desktop/Linux/douyin-fighting/service/video.go:84
[2.392ms] [rows:1] INSERT INTO `videos` (`title`,`play_name`,`cover_name`,`author_id`,`created_at`,`ext_info`,`video_id`) VALUES ('bb','23474522149637505','23474522149637505.jpg',0,'2022-10-29 15:38:26.669',NULL,23474522149637505)
redis
redis 1
redis 4
pipe 
pipe 1
pipe 2
pipe 3
pipe 4
[GIN] 2022/10/29 - 15:38:26 | 200 |  533.898075ms |    192.168.77.1 | POST     "/douyin/publish/action/"
Feed ================
GetFeed 1
GetFeed 2
GetFeed 3
[23474442524970369 23473691677445505]
Video:23474442524970369 : in redis
GetVideoListByIDsRedis: later

2022/10/29 15:38:34 /home/cheng/Desktop/Linux/douyin-fighting/service/video.go:268
[0.387ms] [rows:1] SELECT * FROM `videos` WHERE video_id in (23473691677445505)

2022/10/29 15:38:34 /home/cheng/Desktop/Linux/douyin-fighting/service/comment.go:209
[0.297ms] [rows:0] SELECT `video_id`,COUNT(video_id) as comment_count FROM `comments` WHERE video_id in (23473691677445505) AND `comments`.`deleted_at` IS NULL GROUP BY `video_id`

2022/10/29 15:38:34 /home/cheng/Desktop/Linux/douyin-fighting/service/favorite.go:178
[0.187ms] [rows:0] SELECT `video_id`,COUNT(video_id) as favorite_count FROM `favorites` WHERE video_id in (23473691677445505) and is_favorite = true GROUP BY `video_id`
GetVideoListByIDsSql: 
GetVideoListByIDsRedis:  &[{23474442524970369 a 23474442524970369 23474442524970369.jpg 0 0 0 2022-10-29 15:37:39.207 -0700 PDT <nil>} {0    0 0 0 0001-01-01 00:00:00 +0000 UTC <nil>}]  
 [23474442524970369 23473691677445505]
numVideos:  0
[GIN] 2022/10/29 - 15:38:34 | 500 |    5.847159ms |    192.168.77.1 | GET      "/douyin/feed/?latest_time=1667083073814&token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJVc2VySUQiOjIzNDczNjIxMTk2MzYxMDg5LCJOYW1lIjoiMSIsImV4cCI6MTY2NzE2OTQ1MCwibmJmIjoxNjY3MDgzMDUwLCJpYXQiOjE2NjcwODMwNTB9.ThoK96Tv8SgmOKOhJff9ukH9VDgmX5qqTEu7mMyD0Vw"
publish 1111111111111111111
publish 2222222222222
publish 3333333333333
insert db

2022/10/29 15:40:08 /home/cheng/Desktop/Linux/douyin-fighting/service/video.go:84
[1.839ms] [rows:1] INSERT INTO `videos` (`title`,`play_name`,`cover_name`,`author_id`,`created_at`,`ext_info`,`video_id`) VALUES ('aa','23474693730225537','23474693730225537.jpg',0,'2022-10-29 15:40:08.863',NULL,23474693730225537)
redis
redis 1
redis 4
pipe 
pipe 1
pipe 2
pipe 3
pipe 4
[GIN] 2022/10/29 - 15:40:08 | 200 |   60.510361ms |    192.168.77.1 | POST     "/douyin/publish/action/"
Feed ================
GetFeed 1
GetFeed 2
GetFeed 3
[23474442524970369 23473691677445505]
Video:23474442524970369 : in redis
GetVideoListByIDsRedis: later

2022/10/29 15:40:14 /home/cheng/Desktop/Linux/douyin-fighting/service/video.go:268
[1.006ms] [rows:1] SELECT * FROM `videos` WHERE video_id in (23473691677445505)

2022/10/29 15:40:14 /home/cheng/Desktop/Linux/douyin-fighting/service/comment.go:209
[0.307ms] [rows:0] SELECT `video_id`,COUNT(video_id) as comment_count FROM `comments` WHERE video_id in (23473691677445505) AND `comments`.`deleted_at` IS NULL GROUP BY `video_id`

2022/10/29 15:40:14 /home/cheng/Desktop/Linux/douyin-fighting/service/favorite.go:178
[0.271ms] [rows:0] SELECT `video_id`,COUNT(video_id) as favorite_count FROM `favorites` WHERE video_id in (23473691677445505) and is_favorite = true GROUP BY `video_id`
GetVideoListByIDsSql: 
GetVideoListByIDsRedis:  &[{23474442524970369 a 23474442524970369 23474442524970369.jpg 0 0 0 2022-10-29 15:37:39.207 -0700 PDT <nil>} {0    0 0 0 0001-01-01 00:00:00 +0000 UTC <nil>}]  
 [23474442524970369 23473691677445505]
numVideos:  0
[GIN] 2022/10/29 - 15:40:14 | 500 |    2.796779ms |    192.168.77.1 | GET      "/douyin/feed/?latest_time=1667083073814&token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJVc2VySUQiOjIzNDczNjIxMTk2MzYxMDg5LCJOYW1lIjoiMSIsImV4cCI6MTY2NzE2OTQ1MCwibmJmIjoxNjY3MDgzMDUwLCJpYXQiOjE2NjcwODMwNTB9.ThoK96Tv8SgmOKOhJff9ukH9VDgmX5qqTEu7mMyD0Vw"
